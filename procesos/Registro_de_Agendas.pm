000013338O:8:"stdClass":40:{s:7:"process";a:42:{s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:9:"PRO_TITLE";s:19:"Registro de Agendas";s:15:"PRO_DESCRIPTION";s:69:"Proceso para registrar las agendas tanto de médicos como enfermeras.";s:10:"PRO_PARENT";s:32:"604903739582fa3a17862f3041357520";s:8:"PRO_TIME";d:1;s:12:"PRO_TIMEUNIT";s:4:"DAYS";s:10:"PRO_STATUS";s:6:"ACTIVE";s:12:"PRO_TYPE_DAY";s:0:"";s:8:"PRO_TYPE";s:6:"NORMAL";s:14:"PRO_ASSIGNMENT";s:5:"FALSE";s:12:"PRO_SHOW_MAP";i:0;s:16:"PRO_SHOW_MESSAGE";i:0;s:14:"PRO_SUBPROCESS";i:0;s:14:"PRO_TRI_CREATE";s:0:"";s:12:"PRO_TRI_OPEN";s:0:"";s:15:"PRO_TRI_DELETED";s:0:"";s:16:"PRO_TRI_CANCELED";s:0:"";s:14:"PRO_TRI_PAUSED";s:0:"";s:18:"PRO_TRI_REASSIGNED";s:0:"";s:16:"PRO_TRI_UNPAUSED";s:0:"";s:16:"PRO_TYPE_PROCESS";s:6:"PUBLIC";s:17:"PRO_SHOW_DELEGATE";i:0;s:17:"PRO_SHOW_DYNAFORM";i:0;s:12:"PRO_CATEGORY";s:32:"52804892357ccc9bf579972092497517";s:16:"PRO_SUB_CATEGORY";s:0:"";s:12:"PRO_INDUSTRY";i:0;s:15:"PRO_UPDATE_DATE";s:19:"2019-08-13 18:36:53";s:15:"PRO_CREATE_DATE";s:19:"2016-11-18 19:58:09";s:15:"PRO_CREATE_USER";s:32:"00000000000000000000000000000001";s:10:"PRO_HEIGHT";i:5000;s:9:"PRO_WIDTH";i:10000;s:11:"PRO_TITLE_X";i:30;s:11:"PRO_TITLE_Y";i:10;s:9:"PRO_DEBUG";i:0;s:13:"PRO_DYNAFORMS";a:1:{s:7:"PROCESS";s:0:"";}s:25:"PRO_DERIVATION_SCREEN_TPL";s:0:"";s:8:"PRO_COST";d:0;s:13:"PRO_UNIT_COST";s:0:"";s:8:"PRO_ITEE";i:0;s:15:"PRO_ACTION_DONE";N;s:18:"PRO_CATEGORY_LABEL";s:6:"Health";s:8:"PRO_BPMN";i:0;}s:5:"tasks";a:1:{i:0;a:65:{s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:7:"TAS_UID";s:32:"737487453582fa3e44ac3b5079601788";s:9:"TAS_TITLE";s:25:"Administración de Agenda";s:15:"TAS_DESCRIPTION";s:0:"";s:13:"TAS_DEF_TITLE";s:0:"";s:23:"TAS_DEF_SUBJECT_MESSAGE";s:0:"";s:17:"TAS_DEF_PROC_CODE";s:0:"";s:15:"TAS_DEF_MESSAGE";s:0:"";s:19:"TAS_DEF_DESCRIPTION";s:0:"";s:8:"TAS_TYPE";s:6:"NORMAL";s:12:"TAS_DURATION";d:1;s:14:"TAS_DELAY_TYPE";s:0:"";s:14:"TAS_TEMPORIZER";d:0;s:12:"TAS_TYPE_DAY";s:0:"";s:12:"TAS_TIMEUNIT";s:4:"DAYS";s:9:"TAS_ALERT";s:5:"FALSE";s:21:"TAS_PRIORITY_VARIABLE";s:0:"";s:15:"TAS_ASSIGN_TYPE";s:8:"BALANCED";s:19:"TAS_ASSIGN_VARIABLE";s:30:"@@SYS_NEXT_USER_TO_BE_ASSIGNED";s:18:"TAS_GROUP_VARIABLE";s:0:"";s:24:"TAS_MI_INSTANCE_VARIABLE";s:24:"@@SYS_VAR_TOTAL_INSTANCE";s:24:"TAS_MI_COMPLETE_VARIABLE";s:34:"@@SYS_VAR_TOTAL_INSTANCES_COMPLETE";s:19:"TAS_ASSIGN_LOCATION";s:5:"FALSE";s:25:"TAS_ASSIGN_LOCATION_ADHOC";s:5:"FALSE";s:16:"TAS_TRANSFER_FLY";s:5:"FALSE";s:17:"TAS_LAST_ASSIGNED";s:32:"00000000000000000000000000000001";s:8:"TAS_USER";s:1:"0";s:14:"TAS_CAN_UPLOAD";s:5:"FALSE";s:15:"TAS_VIEW_UPLOAD";s:5:"FALSE";s:33:"TAS_VIEW_ADDITIONAL_DOCUMENTATION";s:5:"FALSE";s:14:"TAS_CAN_CANCEL";s:5:"FALSE";s:13:"TAS_OWNER_APP";s:5:"FALSE";s:7:"STG_UID";s:0:"";s:13:"TAS_CAN_PAUSE";s:5:"FALSE";s:20:"TAS_CAN_SEND_MESSAGE";s:4:"TRUE";s:19:"TAS_CAN_DELETE_DOCS";s:5:"FALSE";s:16:"TAS_SELF_SERVICE";s:5:"FALSE";s:9:"TAS_START";s:4:"TRUE";s:16:"TAS_TO_LAST_USER";s:5:"FALSE";s:19:"TAS_SEND_LAST_EMAIL";s:5:"FALSE";s:14:"TAS_DERIVATION";s:6:"NORMAL";s:8:"TAS_POSX";i:675;s:8:"TAS_POSY";i:201;s:9:"TAS_WIDTH";i:165;s:10:"TAS_HEIGHT";i:40;s:9:"TAS_COLOR";s:0:"";s:11:"TAS_EVN_UID";s:0:"";s:12:"TAS_BOUNDARY";s:0:"";s:25:"TAS_DERIVATION_SCREEN_TPL";s:0:"";s:23:"TAS_SELFSERVICE_TIMEOUT";i:0;s:20:"TAS_SELFSERVICE_TIME";i:0;s:25:"TAS_SELFSERVICE_TIME_UNIT";s:0:"";s:27:"TAS_SELFSERVICE_TRIGGER_UID";s:0:"";s:25:"TAS_SELFSERVICE_EXECUTION";s:10:"EVERY_TIME";s:25:"TAS_NOT_EMAIL_FROM_FORMAT";i:0;s:11:"TAS_OFFLINE";s:5:"FALSE";s:20:"TAS_EMAIL_SERVER_UID";s:0:"";s:13:"TAS_AUTO_ROOT";s:5:"FALSE";s:22:"TAS_RECEIVE_SERVER_UID";s:0:"";s:22:"TAS_RECEIVE_LAST_EMAIL";s:5:"FALSE";s:29:"TAS_RECEIVE_EMAIL_FROM_FORMAT";i:0;s:24:"TAS_RECEIVE_MESSAGE_TYPE";s:4:"text";s:28:"TAS_RECEIVE_MESSAGE_TEMPLATE";s:18:"alert_message.html";s:27:"TAS_RECEIVE_SUBJECT_MESSAGE";N;s:19:"TAS_RECEIVE_MESSAGE";N;}}s:6:"routes";a:1:{i:0;a:18:{s:7:"ROU_UID";s:32:"2256651595d41bd9b4dcbb2088792198";s:10:"ROU_PARENT";s:1:"0";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:7:"TAS_UID";s:32:"737487453582fa3e44ac3b5079601788";s:13:"ROU_NEXT_TASK";s:2:"-1";s:8:"ROU_CASE";s:1:"1";s:8:"ROU_TYPE";s:10:"SEQUENTIAL";s:11:"ROU_DEFAULT";s:1:"0";s:13:"ROU_CONDITION";s:0:"";s:16:"ROU_TO_LAST_USER";s:5:"FALSE";s:12:"ROU_OPTIONAL";s:5:"FALSE";s:14:"ROU_SEND_EMAIL";s:4:"TRUE";s:16:"ROU_SOURCEANCHOR";s:1:"1";s:16:"ROU_TARGETANCHOR";s:1:"0";s:11:"ROU_TO_PORT";s:1:"1";s:13:"ROU_FROM_PORT";s:1:"2";s:11:"ROU_EVN_UID";s:32:"2134664545d41bd9b4f70e4077900431";s:7:"GAT_UID";s:0:"";}}s:5:"lanes";a:4:{i:0;a:9:{s:7:"SWI_UID";s:32:"2969708455d41bd9b50f854070027986";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"SWI_TYPE";s:4:"TEXT";s:5:"SWI_X";i:75;s:5:"SWI_Y";i:193;s:9:"SWI_WIDTH";i:0;s:10:"SWI_HEIGHT";i:0;s:12:"SWI_NEXT_UID";s:0:"";s:8:"SWI_TEXT";s:14:"Citas Médicas";}i:1;a:9:{s:7:"SWI_UID";s:32:"4446897285d41bd9b56a4e2059134565";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"SWI_TYPE";s:4:"LINE";s:5:"SWI_X";i:0;s:5:"SWI_Y";i:409;s:9:"SWI_WIDTH";i:0;s:10:"SWI_HEIGHT";i:0;s:12:"SWI_NEXT_UID";s:0:"";s:8:"SWI_TEXT";s:0:"";}i:2;a:9:{s:7:"SWI_UID";s:32:"8924057685d41bd9b52aa36015568342";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"SWI_TYPE";s:4:"LINE";s:5:"SWI_X";i:213;s:5:"SWI_Y";i:0;s:9:"SWI_WIDTH";i:0;s:10:"SWI_HEIGHT";i:0;s:12:"SWI_NEXT_UID";s:0:"";s:8:"SWI_TEXT";s:0:"";}i:3;a:9:{s:7:"SWI_UID";s:32:"9905840325d41bd9b542c80089750259";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"SWI_TYPE";s:4:"LINE";s:5:"SWI_X";i:0;s:5:"SWI_Y";i:40;s:9:"SWI_WIDTH";i:0;s:10:"SWI_HEIGHT";i:0;s:12:"SWI_NEXT_UID";s:0:"";s:8:"SWI_TEXT";s:0:"";}}s:8:"gateways";a:0:{}s:6:"inputs";a:0:{}s:7:"outputs";a:0:{}s:9:"dynaforms";a:5:{i:0;a:10:{s:7:"DYN_UID";s:32:"165540605582fca83250d83074069057";s:9:"DYN_TITLE";s:19:"FRM_AGENDA_ELIMINAR";s:15:"DYN_DESCRIPTION";s:0:"";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"DYN_TYPE";s:7:"xmlform";s:12:"DYN_FILENAME";s:65:"604903739582fa3a17862f3041357520/165540605582fca83250d83074069057";s:11:"DYN_CONTENT";N;s:9:"DYN_LABEL";N;s:11:"DYN_VERSION";i:0;s:15:"DYN_UPDATE_DATE";N;}i:1;a:10:{s:7:"DYN_UID";s:32:"720997442582fa4495de3e7089978619";s:9:"DYN_TITLE";s:10:"FRM_OPCION";s:15:"DYN_DESCRIPTION";s:0:"";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"DYN_TYPE";s:7:"xmlform";s:12:"DYN_FILENAME";s:65:"604903739582fa3a17862f3041357520/720997442582fa4495de3e7089978619";s:11:"DYN_CONTENT";N;s:9:"DYN_LABEL";N;s:11:"DYN_VERSION";i:0;s:15:"DYN_UPDATE_DATE";N;}i:2;a:10:{s:7:"DYN_UID";s:32:"727417476582fcb08e75276054332861";s:9:"DYN_TITLE";s:22:"GRL_AGENDA_REGISTRADAS";s:15:"DYN_DESCRIPTION";s:0:"";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"DYN_TYPE";s:4:"grid";s:12:"DYN_FILENAME";s:65:"604903739582fa3a17862f3041357520/727417476582fcb08e75276054332861";s:11:"DYN_CONTENT";N;s:9:"DYN_LABEL";N;s:11:"DYN_VERSION";i:0;s:15:"DYN_UPDATE_DATE";N;}i:3;a:10:{s:7:"DYN_UID";s:32:"742056429582fa534ea4d12068905339";s:9:"DYN_TITLE";s:16:"GRL_AGENDA_NUEVA";s:15:"DYN_DESCRIPTION";s:0:"";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"DYN_TYPE";s:4:"grid";s:12:"DYN_FILENAME";s:65:"604903739582fa3a17862f3041357520/742056429582fa534ea4d12068905339";s:11:"DYN_CONTENT";N;s:9:"DYN_LABEL";N;s:11:"DYN_VERSION";i:0;s:15:"DYN_UPDATE_DATE";N;}i:4;a:10:{s:7:"DYN_UID";s:32:"926723442582fa58d946304042874862";s:9:"DYN_TITLE";s:16:"FRM_AGENDA_NUEVA";s:15:"DYN_DESCRIPTION";s:0:"";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"DYN_TYPE";s:7:"xmlform";s:12:"DYN_FILENAME";s:65:"604903739582fa3a17862f3041357520/926723442582fa58d946304042874862";s:11:"DYN_CONTENT";N;s:9:"DYN_LABEL";N;s:11:"DYN_VERSION";i:0;s:15:"DYN_UPDATE_DATE";N;}}s:5:"steps";a:3:{i:0;a:8:{s:8:"STEP_UID";s:32:"243306525582fa4d2e1bec5049946012";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:7:"TAS_UID";s:32:"737487453582fa3e44ac3b5079601788";s:13:"STEP_TYPE_OBJ";s:8:"DYNAFORM";s:12:"STEP_UID_OBJ";s:32:"720997442582fa4495de3e7089978619";s:14:"STEP_CONDITION";s:0:"";s:13:"STEP_POSITION";i:1;s:9:"STEP_MODE";s:4:"EDIT";}i:1;a:8:{s:8:"STEP_UID";s:32:"268675620582fbedfba3ae8016632496";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:7:"TAS_UID";s:32:"737487453582fa3e44ac3b5079601788";s:13:"STEP_TYPE_OBJ";s:8:"DYNAFORM";s:12:"STEP_UID_OBJ";s:32:"926723442582fa58d946304042874862";s:14:"STEP_CONDITION";s:17:"@@DRP_OPCION == 0";s:13:"STEP_POSITION";i:2;s:9:"STEP_MODE";s:4:"EDIT";}i:2;a:8:{s:8:"STEP_UID";s:32:"776367560582fe25d53b4f4081978007";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:7:"TAS_UID";s:32:"737487453582fa3e44ac3b5079601788";s:13:"STEP_TYPE_OBJ";s:8:"DYNAFORM";s:12:"STEP_UID_OBJ";s:32:"165540605582fca83250d83074069057";s:14:"STEP_CONDITION";s:17:"@@DRP_OPCION == 1";s:13:"STEP_POSITION";i:3;s:9:"STEP_MODE";s:4:"EDIT";}}s:8:"triggers";a:2:{i:0;a:7:{s:7:"TRI_UID";s:32:"213428665582fe24f4fc270078003166";s:9:"TRI_TITLE";s:19:"TGG_AGENDA_ELIMINAR";s:15:"TRI_DESCRIPTION";s:0:"";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"TRI_TYPE";s:6:"SCRIPT";s:10:"TRI_WEBBOT";s:300:"$agendas = @@TXT_AGENDA_ELIMINAR;
$agenda = explode('*-*',$agendas);

@@cantidad_agendas = count($agenda);

for ($cnt = 0; $cnt <= count($agenda); $cnt++){
	$agenda_eliminar = $agenda[$cnt];
	$query = "delete from PMT_AGENDA where cod_agenda = '$agenda_eliminar';";
	$result = executeQuery($query);
}";s:9:"TRI_PARAM";s:0:"";}i:1;a:7:{s:7:"TRI_UID";s:32:"378172333582fbec9605d01032781544";s:9:"TRI_TITLE";s:16:"TGG_AGENDA_CREAR";s:15:"TRI_DESCRIPTION";s:0:"";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"TRI_TYPE";s:6:"SCRIPT";s:10:"TRI_WEBBOT";s:970:"$num_doc 	= @@TXT_USERNAME;

$query 		= "select USR_UID from PMT_PROFESIONAL where DOCUMENTO='$num_doc'";
$result 	= executeQuery($query);
$usr_uid 	=$result['1']['USR_UID'];


if(@=GRL_AGENDA_NUEVA[1]['TXT_FECHA'] != ""){
	$c=1;
	foreach (@=GRL_AGENDA_NUEVA as $row) {
	   $c++;
	}

	for($i =1; $i<$c ; $i++) {
		$fecha 			= @=GRL_AGENDA_NUEVA[$i]['TXT_FECHA'];
		$hora_inicio 	= @=GRL_AGENDA_NUEVA[$i]['TXT_HORA_INI'];
		$hora_fin 		= @=GRL_AGENDA_NUEVA[$i]['TXT_HORA_FIN'];
		$tipo 			= ' '.@=GRL_AGENDA_NUEVA[$i]['TXT_TIPO'];                  
          
        $query 		= "select cod_atencion from hlt_atencion where descripcion='$tipo';";
        $result 	= executeQuery($query,'734483671582fba5f8f5881092534303');
        $atencion 	= $result['1']['cod_atencion'];
	          
		$query = "INSERT INTO PMT_AGENDA (USR_UID,FECHA,HORA_INICIO,HORA_FIN,ATENCION) VALUES('$usr_uid','$fecha','$hora_inicio','$hora_fin','$atencion')";
		$res = executeQuery($query);
	}
}";s:9:"TRI_PARAM";s:0:"";}}s:9:"taskusers";a:0:{}s:8:"groupwfs";a:0:{}s:12:"steptriggers";a:2:{i:0;a:6:{s:8:"STEP_UID";s:32:"268675620582fbedfba3ae8016632496";s:7:"TAS_UID";s:32:"737487453582fa3e44ac3b5079601788";s:7:"TRI_UID";s:32:"378172333582fbec9605d01032781544";s:7:"ST_TYPE";s:5:"AFTER";s:12:"ST_CONDITION";s:0:"";s:11:"ST_POSITION";s:1:"1";}i:1;a:6:{s:8:"STEP_UID";s:32:"776367560582fe25d53b4f4081978007";s:7:"TAS_UID";s:32:"737487453582fa3e44ac3b5079601788";s:7:"TRI_UID";s:32:"213428665582fe24f4fc270078003166";s:7:"ST_TYPE";s:5:"AFTER";s:12:"ST_CONDITION";s:0:"";s:11:"ST_POSITION";s:1:"1";}}s:13:"dbconnections";a:1:{i:0;a:12:{s:7:"DBS_UID";s:32:"734483671582fba5f8f5881092534303";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:8:"DBS_TYPE";s:5:"pgsql";s:10:"DBS_SERVER";s:9:"localhost";s:17:"DBS_DATABASE_NAME";s:7:"shealth";s:12:"DBS_USERNAME";s:8:"postgres";s:12:"DBS_PASSWORD";s:23:"y9TaxsvbpZqm_2NnV3ujj3w";s:8:"DBS_PORT";i:5432;s:10:"DBS_ENCODE";s:4:"UTF8";s:19:"DBS_CONNECTION_TYPE";s:6:"NORMAL";s:7:"DBS_TNS";s:0:"";s:15:"DBS_DESCRIPTION";s:80:"Base de datos en postgres para el manejo de la información usada para reportes.";}}s:12:"reportTables";a:0:{}s:16:"reportTablesVars";a:0:{}s:14:"stepSupervisor";a:0:{}s:17:"objectPermissions";a:0:{}s:10:"subProcess";a:0:{}s:11:"caseTracker";a:0:{}s:17:"caseTrackerObject";a:0:{}s:5:"stage";a:0:{}s:14:"fieldCondition";a:0:{}s:5:"event";a:1:{i:0;a:21:{s:7:"EVN_UID";s:32:"2134664545d41bd9b4f70e4077900431";s:7:"PRO_UID";s:32:"604903739582fa3a17862f3041357520";s:10:"EVN_STATUS";s:6:"ACTIVE";s:15:"EVN_WHEN_OCCURS";s:6:"SINGLE";s:14:"EVN_RELATED_TO";s:8:"MULTIPLE";s:7:"TAS_UID";s:0:"";s:16:"EVN_TAS_UID_FROM";s:32:"737487453582fa3e44ac3b5079601788";s:14:"EVN_TAS_UID_TO";s:0:"";s:26:"EVN_TAS_ESTIMATED_DURATION";d:0;s:13:"EVN_TIME_UNIT";s:4:"DAYS";s:8:"EVN_WHEN";d:1;s:16:"EVN_MAX_ATTEMPTS";i:3;s:10:"EVN_ACTION";s:0:"";s:14:"EVN_CONDITIONS";N;s:21:"EVN_ACTION_PARAMETERS";b:0;s:7:"TRI_UID";s:0:"";s:8:"EVN_POSX";i:757;s:8:"EVN_POSY";i:251;s:8:"EVN_TYPE";s:17:"bpmnEventEmptyEnd";s:11:"TAS_EVN_UID";s:0:"";s:15:"EVN_DESCRIPTION";s:0:"";}}s:13:"caseScheduler";a:0:{}s:15:"processCategory";a:4:{s:12:"CATEGORY_UID";s:32:"52804892357ccc9bf579972092497517";s:15:"CATEGORY_PARENT";s:1:"0";s:13:"CATEGORY_NAME";s:6:"Health";s:13:"CATEGORY_ICON";s:0:"";}s:19:"taskExtraProperties";a:0:{}s:11:"processUser";a:0:{}s:16:"processVariables";a:0:{}s:8:"webEntry";a:0:{}s:13:"webEntryEvent";a:0:{}s:11:"messageType";a:0:{}s:19:"messageTypeVariable";a:0:{}s:22:"messageEventDefinition";a:0:{}s:10:"scriptTask";a:0:{}s:10:"timerEvent";a:0:{}s:10:"emailEvent";a:0:{}s:12:"filesManager";a:0:{}s:16:"abeConfiguration";a:0:{}s:11:"elementTask";a:0:{}}000000032165540605582fca83250d83074069057000006642<?xml version="1.0" encoding="UTF-8"?>
<dynaForm name="604903739582fa3a17862f3041357520/165540605582fca83250d83074069057" enabletemplate="1" type="xmlform" width="900" mode="" nextstepsave="prompt" printdynaform="" adjustgridswidth="">
  <arrow type="javascript" meta=""><![CDATA[function arrow(){
  hidden(getField("DYN_BACKWARD").parentNode);
  hidden(getField("DYN_FORWARD").parentNode);
}
arrow();]]></arrow>
  <TIT_PRINCIPAL type="title" required="0" readonly="0" optgroup="0">
    <es>ELIMINAR AGENDA</es>
  </TIT_PRINCIPAL>
  <SUB_INFORMACION type="subtitle" required="0" readonly="0" optgroup="0">
    <es><![CDATA[INFORMACIÓN DEL PROFESIONAL ]]></es>
  </SUB_INFORMACION>
  <TXT_USERNAME type="suggest" required="0" dependentfields="TXT_NOM_DOC,TXT_APE_DOC,DRP_TIPO_DOC,TXT_NUM_DOC_DOC,TXT_EMAIL_DOC,TXT_ESP_DOC" size="150" mode="edit" sqlconnection="workflow" maxresults="20" shownoresults="1" searchtype="*searchtype*" table="0" readonly="0" optgroup="0"><![CDATA[SELECT A.DOCUMENTO,A.DOCUMENTO AS CED,CONCAT(B.USR_FIRSTNAME,' ',B.USR_LASTNAME)  FROM PMT_PROFESIONAL A LEFT JOIN USERS B ON A.USR_UID=B.USR_UID WHERE (B.USR_ROLE = 'Medico' OR B.USR_ROLE = 'Enfermeria') AND USR_STATUS = 'ACTIVE']]><en><![CDATA[Número de Documento]]></en><es><![CDATA[Número de Documento]]></es></TXT_USERNAME>
  <TXT_NOM_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="30" mode="edit" sqlconnection="workflow" optgroup="0">SELECT B.USR_FIRSTNAME FROM  PMT_PROFESIONAL A LEFT JOIN USERS B ON A.USR_UID = B.USR_UID WHERE A.DOCUMENTO = @#TXT_USERNAME<en>Nombres</en><es>Nombres</es></TXT_NOM_DOC>
  <TXT_APE_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="30" mode="edit" sqlconnection="workflow" optgroup="0"> SELECT B.USR_LASTNAME FROM  PMT_PROFESIONAL A LEFT JOIN USERS B ON A.USR_UID = B.USR_UID WHERE A.DOCUMENTO = @#TXT_USERNAME<en>Apellidos</en><es>Apellidos</es></TXT_APE_DOC>
  <DRP_TIPO_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="30" mode="edit" sqlconnection="workflow" optgroup="0">SELECT B.DESCRIPCION FROM  PMT_PROFESIONAL A LEFT JOIN PMT_DOCUMENTO B ON A.COD_DOCUMENTO=B.COD_DOCUMENTO WHERE A.DOCUMENTO = @#TXT_USERNAME<en>Tipo de Documento</en><es>Tipo de Documento</es></DRP_TIPO_DOC>
  <TXT_NUM_DOC_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="15" mode="edit" sqlconnection="workflow" optgroup="0">SELECT DOCUMENTO FROM  PMT_PROFESIONAL WHERE DOCUMENTO = @#TXT_USERNAME<en><![CDATA[Número de Documento]]></en><es><![CDATA[Número de Documento]]></es></TXT_NUM_DOC_DOC>
  <TXT_EMAIL_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="40" mode="edit" sqlconnection="workflow" optgroup="0">SELECT B.USR_EMAIL FROM  PMT_PROFESIONAL A LEFT JOIN USERS B ON A.USR_UID = B.USR_UID WHERE A.DOCUMENTO = @#TXT_USERNAME<en><![CDATA[Correo Eletrónico]]></en><es><![CDATA[Correo Eletrónico]]></es></TXT_EMAIL_DOC>
  <TXT_ESP_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="40" mode="edit" sqlconnection="workflow" optgroup="0">SELECT ESPECIALIDAD FROM  PMT_PROFESIONAL WHERE DOCUMENTO = @#TXT_USERNAME<en>Especialidad</en><es>Especialidad</es></TXT_ESP_DOC>
  <SUB_AGENDA1 type="subtitle" required="0" readonly="0" optgroup="0">
    <es>AGENDAS REGISTRADAS</es>
  </SUB_AGENDA1>
  <GRL_AGENDA_REGISTRADAS type="grid" xmlgrid="604903739582fa3a17862f3041357520/727417476582fcb08e75276054332861" addrow="0" deleterow="0" required="0" readonly="0" optgroup="0"/>
  <BTN_TERMINAR type="submit" required="0" readonly="0" optgroup="0">
    <en>Continuar</en>
    <es>Terminar</es>
  </BTN_TERMINAR>
  <eliminar_agenda type="javascript" meta=""><![CDATA[getField("BTN_BUSCAR").onclick = function(){

  clearGrid();

  var q=getField("TXT_USERNAME").value;
  
  if(q == ''){
    alert("Por favor seleccione un profesional para realizar la busqueda");
    return false;
  }

  if (window.XMLHttpRequest)
    xmlhttp=new XMLHttpRequest();
  else 
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

  xmlhttp.onreadystatechange=function(){
    if(xmlhttp.readyState==4 && xmlhttp.status==200){
       
        var rows = eval('(' + xmlhttp.responseText + ')');

        for (var i = 0; i < rows.length; i++){
          if((i + 1) != 1){
            getObject("GRL_AGENDA_REGISTRADAS").addGridRow();
          }

          getGridField("GRL_AGENDA_REGISTRADAS",(i + 1),"TXT_COD_AGENDA").value   = rows[i].cod_agenda;
          getGridField("GRL_AGENDA_REGISTRADAS",(i + 1),"TXT_FECHA").value     = rows[i].fecha;
          getGridField("GRL_AGENDA_REGISTRADAS",(i + 1),"TXT_HORA_INI").value   = rows[i].hora_inicio;
          getGridField("GRL_AGENDA_REGISTRADAS",(i + 1),"TXT_HORA_FIN").value   = rows[i].hora_fin;
          getGridField("GRL_AGENDA_REGISTRADAS",(i + 1),"TXT_TIPO").value     = rows[i].atencion;
          var citas                                 = rows[i].citas; 
          if(citas != '0'){
            disable(getGridField("GRL_AGENDA_REGISTRADAS",(i + 1),"CHK_ELIMINAR"));        
          }
          else{            
            enable(getGridField("GRL_AGENDA_REGISTRADAS",(i + 1),"CHK_ELIMINAR"));
          }          
        }
      }
  }
  xmlhttp.open("POST", "/eliminarAgenda.php?q="+q, false);
  xmlhttp.send();
}

function clearGrid() {
   var grd = getObject('GRL_AGENDA_REGISTRADAS');
   var i = Number_Rows_Grid('GRL_AGENDA_REGISTRADAS', "TXT_COD_AGENDA");
   for (i; i > 1; i--) {
       grd.deleteGridRow(i, true);
   }
   //The first row can't be deleted, so clear the fields in the first row:
   for (i = 0; i < grd.aFields.length; i++) {
       getGridField('GRL_AGENDA_REGISTRADAS', 1, grd.aFields[i].sFieldName).value = "";
   }
 return false;
}

function setStyles2(obj) {
   //obj.style.fontFamily="Courier";
   //obj.style.fontSize="10pt";
   obj.style.color="red";
   //obj.style.backgroundColor="yellow";
   //obj.style.textAlign="right";   
}

getField("BTN_TERMINAR").form.onsubmit = function(){

  var agendas = '';

  for(i=1; i<=Number_Rows_Grid("GRL_AGENDA_REGISTRADAS", "TXT_COD_AGENDA"); i++){

        if(getGridField("GRL_AGENDA_REGISTRADAS",i,"CHK_ELIMINAR").checked == true){
          //opc++; fila = i; 
          agendas += getGridField("GRL_AGENDA_REGISTRADAS",i,"TXT_COD_AGENDA").value+'*-*';
        }
    }
    getField("TXT_AGENDA_ELIMINAR").value = agendas;
}]]></eliminar_agenda>
  <BTN_BUSCAR type="button" required="0" readonly="0" optgroup="0">
    <en>Buscar Agenda</en>
  </BTN_BUSCAR>
  <TXT_AGENDA_ELIMINAR type="hidden" mode="edit" required="0" readonly="0" optgroup="0"/>
</dynaForm>
000000032165540605582fca83250d83074069057000004170<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
</head>
<body>
<form id="{$form_id}" class="formDefault" style="margin:0px;" action="{$form_action}" method="post" name="{$form_name}" enctype="multipart/form-data" onsubmit="return validateForm('{$form_objectRequiredFields}');">
<div class="borderForm" style="width:{$form_width}; padding-left:0; padding-right:0; border-width:{$form_border};">
<div class="boxTop">
<div class="a">&nbsp;</div>
<div class="b">&nbsp;</div>
<div class="c">&nbsp;</div>
</div>
<div class="content" style="height:{$form_height};">
<table class="mceItemTable" style="width: 99%;">
<tbody>
<tr>
<td valign="top"><input id="__notValidateThisFields__" class="notValidateThisFields" type="hidden" name="__notValidateThisFields__" value="{$form_objectRequiredFields}" /> <input id="DynaformRequiredFields" type="hidden" name="DynaformRequiredFields" value="{$form_objectRequiredFields}" /> <input id="__DynaformName__" type="hidden" name="__DynaformName__" value="{$form_name}" />
<table class="mceItemTable" style="width: 100%;" border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormTitle" colspan="2" align="center">{$form.TIT_PRINCIPAL}</td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormSubTitle" colspan="2" align=""><span>{$form.SUB_INFORMACION}</span></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align=""><font color="#000000"><span>{$TXT_USERNAME}&nbsp;</span><span>{$form.TXT_USERNAME}</span></font></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align=""><font color="#000000"><span><span>{$TXT_NOM_DOC}</span>{$form.TXT_NOM_DOC} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span>&nbsp; &nbsp;</span><span>{$TXT_APE_DOC}&nbsp;{$form.TXT_APE_DOC}</span></span></font></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align=""><font color="#000000">{$DRP_TIPO_DOC}&nbsp;<span>{$form.DRP_TIPO_DOC} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span>{$TXT_NUM_DOC_DOC}&nbsp;</span><span>{$form.TXT_NUM_DOC_DOC}</span>&nbsp;&nbsp;</span></font></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align=""><font color="#000000">{$TXT_ESP_DOC}&nbsp;<span>{$form.TXT_ESP_DOC} &nbsp; &nbsp; &nbsp; &nbsp;<span>{$TXT_EMAIL_DOC}&nbsp;</span><span>{$form.TXT_EMAIL_DOC}</span></span></font></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align=""><span>{$form.BTN_BUSCAR}</span>&nbsp;<span>{$TXT_AGENDA_ELIMINAR}{$form.TXT_AGENDA_ELIMINAR}</span></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormSubTitle" colspan="2" align=""><span>{$form.SUB_AGENDA1}</span></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td colspan="2">{$form.GRL_AGENDA_REGISTRADAS}</td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align="center">&nbsp;<span>{$form.BTN_TERMINAR}</span></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="boxBottom">
<div class="a">&nbsp;</div>
<div class="b">&nbsp;</div>
<div class="c">&nbsp;</div>
</div>
</div>
<script type="text/javascript">// <![CDATA[
{$form.arrow}
// ]]></script>
<script type="text/javascript">// <![CDATA[
{$form.eliminar_agenda}
// ]]></script>
<br />{$__DYNAFORM_OPTIONS}{$form.__DYNAFORM_OPTIONS}<br /><br /><br /><br /></form>
000000032720997442582fa4495de3e7089978619000001149<?xml version="1.0" encoding="UTF-8"?>
<dynaForm name="604903739582fa3a17862f3041357520/720997442582fa4495de3e7089978619" enabletemplate="1" type="xmlform" width="700" mode="" nextstepsave="prompt" printdynaform="" adjustgridswidth="">
  <arrow type="javascript" meta=""><![CDATA[function arrow(){
  hidden(getField("DYN_BACKWARD").parentNode);
  hidden(getField("DYN_FORWARD").parentNode);
}
arrow();]]></arrow>
  <TIT_PRINCIPAL type="title" required="0" readonly="0" optgroup="0">
    <es><![CDATA[ADMINISTRACIÓN DE AGENDA MEDICA ]]></es>
  </TIT_PRINCIPAL>
  <DRP_OPCION type="dropdown" required="0" readonly="0" optgroup="0" mode="edit">
    <en>Seleccione una opción para continuar                  
      <option name="0">Crear Agenda </option>
      <option name="1">Eliminar Agenda</option></en>
  
    <es>Seleccione una opción para continuar            
      <option name="0">Crear Agenda Nueva</option></es>
  </DRP_OPCION>
  <BTN_CONTINUAR type="submit" required="0" readonly="0" optgroup="0">
    <es>Continuar</es>
  </BTN_CONTINUAR>
  <TXT_NOMBRE_MED type="hidden" mode="edit" required="0" readonly="0" optgroup="0"/>
</dynaForm>
000000032720997442582fa4495de3e7089978619000002654<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
</head>
<body>
<form id="{$form_id}" class="formDefault" style="margin:0px;" action="{$form_action}" method="post" name="{$form_name}" enctype="multipart/form-data" onsubmit="return validateForm('{$form_objectRequiredFields}');">
<div class="borderForm" style="width:{$form_width}; padding-left:0; padding-right:0; border-width:{$form_border};">
<div class="boxTop">
<div class="a">&nbsp;</div>
<div class="b">&nbsp;</div>
<div class="c">&nbsp;</div>
</div>
<div class="content" style="height:{$form_height};">
<table class="mceItemTable" style="width: 99%;">
<tbody>
<tr>
<td valign="top"><input id="__notValidateThisFields__" class="notValidateThisFields" type="hidden" name="__notValidateThisFields__" value="{$form_objectRequiredFields}" /> <input id="DynaformRequiredFields" type="hidden" name="DynaformRequiredFields" value="{$form_objectRequiredFields}" /> <input id="__DynaformName__" type="hidden" name="__DynaformName__" value="{$form_name}" />
<table class="mceItemTable" style="width: 100%;" border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="withoutLabel" style="height:auto;" colspan="2">{$form.__DYNAFORM_OPTIONS}</td>
</tr>
<tr>
<td class="FormTitle" colspan="2" align="center">{$form.TIT_PRINCIPAL}</td>
</tr>
<tr>
<td class="formtitle" style="border: 1px solid #bdcedb; background-color: #bdcedb; " colspan="2" align="center" data-mce-style="border: 1px solid #bdcedb; background-color: #bdcedb; "><font color="#000000"><span>{$TXT_NOMBRE_MED}{$form.TXT_NOMBRE_MED}</span></font></td>
</tr>
<tr>
<td class="formtitle" style="border: 1px solid #bdcedb; background-color: #bdcedb; " colspan="2" align="center" data-mce-style="border: 1px solid #bdcedb; background-color: #bdcedb; "><font color="#000000">&nbsp;<span>{$DRP_OPCION}</span></font></td>
</tr>
<tr>
<td class="formtitle" style="border: 1px solid #bdcedb; background-color: #bdcedb; " colspan="2" align="center" data-mce-style="border: 1px solid #bdcedb; background-color: #bdcedb; ">{$form.DRP_OPCION}</td>
</tr>
<tr>
<td class="formbutton" style="background-color: #bdcedb; " colspan="2" align="center" data-mce-style="background-color: #bdcedb; ">{$form.BTN_CONTINUAR}</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="boxBottom">
<div class="a">&nbsp;</div>
<div class="b">&nbsp;</div>
<div class="c">&nbsp;</div>
</div>
</div>
<script type="text/javascript">// <![CDATA[
{$form.arrow}
// ]]></script>
<br /><br /><br /><br /><br /><br />{$validar_formulario}{$form.validar_formulario}</form>
000000032727417476582fcb08e75276054332861000001468<?xml version="1.0" encoding="UTF-8"?>
<dynaForm name="604903739582fa3a17862f3041357520/727417476582fcb08e75276054332861" enabletemplate="0" type="grid" width="500" mode="" nextstepsave="prompt" printdynaform="" adjustgridswidth="">
  <TXT_COD_AGENDA type="text" maxlength="64" validate="Any" required="0" readonly="1" size="10" mode="edit" optgroup="0">
    <es><![CDATA[Código]]></es>
  </TXT_COD_AGENDA>
  <TXT_FECHA type="text" maxlength="64" validate="Any" required="0" readonly="1" size="15" mode="edit" optgroup="0">
    <es>Fecha</es>
  </TXT_FECHA>
  <TXT_HORA_INI type="text" maxlength="64" validate="Any" required="0" readonly="1" size="15" mode="edit" optgroup="0">
    <es>Hora de Inicio</es>
  </TXT_HORA_INI>
  <TXT_HORA_FIN type="text" maxlength="64" validate="Any" required="0" readonly="1" size="15" mode="edit" optgroup="0">
    <es>Hora de Fin</es>
  </TXT_HORA_FIN>
  <TXT_TIPO type="text" maxlength="64" validate="Any" required="0" readonly="1" size="40" mode="edit" optgroup="0">
    <es><![CDATA[Tipo de Atención]]></es>
  </TXT_TIPO>
  <CHK_ELIMINAR type="checkbox" value="On" falsevalue="Off" defaultvalue="Off" readonly="1" hint="Si la casilla no permite realizar la selección, es debido a que se encontraron citas relacionadas a esta agenda. Para eliminar esta agenda se deben eliminar la citas previamente agendadas." required="0" optgroup="0">
    <en>Eliminar agenda</en>
  
    <es>Eliminar agenda</es>
  </CHK_ELIMINAR>
</dynaForm>
000000032742056429582fa534ea4d12068905339000001176<?xml version="1.0" encoding="UTF-8"?>
<dynaForm type="grid" name="604903739582fa3a17862f3041357520/742056429582fa534ea4d12068905339" width="500" enabletemplate="0" mode="" nextstepsave="prompt">
<TXT_FECHA type="text" maxlength="64" validate="Any" required="0" readonly="1" size="15" mode="edit" optgroup="0">
    <es>Fecha</es>
  </TXT_FECHA>
  <TXT_DIA type="text" maxlength="64" validate="Any" required="0" readonly="1" size="15" mode="edit" optgroup="0">
    <es><![CDATA[Día]]></es>
  </TXT_DIA>
  <TXT_JORNADA type="text" maxlength="64" validate="Any" required="0" readonly="1" size="15" mode="edit" optgroup="0">
    <es>Jornada</es>
  </TXT_JORNADA>
  <TXT_HORA_INI type="text" maxlength="64" validate="Any" required="0" readonly="1" size="15" mode="edit" optgroup="0">
    <es>Hora de Inicio</es>
  </TXT_HORA_INI>
  <TXT_HORA_FIN type="text" maxlength="64" validate="Any" required="0" readonly="1" size="15" mode="edit" optgroup="0">
    <es>Hora de Fin</es>
  </TXT_HORA_FIN>
  <TXT_TIPO type="text" maxlength="64" validate="Any" required="0" readonly="1" size="15" mode="edit" optgroup="0">
    <es><![CDATA[Tipo de Atención]]></es>
  </TXT_TIPO>
  
</dynaForm>000000032926723442582fa58d946304042874862000012953<?xml version="1.0" encoding="UTF-8"?>
<dynaForm name="604903739582fa3a17862f3041357520/926723442582fa58d946304042874862" enabletemplate="1" type="xmlform" width="1000" mode="" nextstepsave="prompt" printdynaform="" adjustgridswidth="">
  <arrow type="javascript" meta=""><![CDATA[function arrow(){
  hidden(getField("DYN_BACKWARD").parentNode);
  hidden(getField("DYN_FORWARD").parentNode);
}
arrow();]]></arrow>
  <TIT_PRINCIPAL type="title" required="0" readonly="0" optgroup="0">
    <es><![CDATA[REGISTRAR AGENDA]]></es>
  </TIT_PRINCIPAL>
  <SUB_INFORMACION type="subtitle" required="0" readonly="0" optgroup="0">
    <es><![CDATA[INFORMACIÓN DEL PROFESIONAL ]]></es>
  </SUB_INFORMACION>
  <TXT_USERNAME type="suggest" required="0" dependentfields="TXT_NOM_DOC,TXT_APE_DOC,DRP_TIPO_DOC,TXT_NUM_DOC_DOC,TXT_EMAIL_DOC,TXT_ESP_DOC" size="150" mode="edit" sqlconnection="workflow" maxresults="20" shownoresults="1" searchtype="*searchtype*" table="0" readonly="0" optgroup="0"><![CDATA[SELECT A.DOCUMENTO,A.DOCUMENTO AS CED,CONCAT(B.USR_FIRSTNAME,' ',B.USR_LASTNAME)  FROM PMT_PROFESIONAL A LEFT JOIN USERS B ON A.USR_UID=B.USR_UID WHERE (B.USR_ROLE = 'Medico' OR B.USR_ROLE = 'Enfermeria') AND USR_STATUS = 'ACTIVE']]><en>Número de Documento</en><es>Número de Documento</es></TXT_USERNAME>
  <TXT_NOM_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="30" mode="edit" sqlconnection="workflow" optgroup="0"><![CDATA[SELECT B.USR_FIRSTNAME FROM  PMT_PROFESIONAL A LEFT JOIN USERS B ON A.USR_UID = B.USR_UID WHERE A.DOCUMENTO = @#TXT_USERNAME]]><en>Nombres</en><es>Nombres</es></TXT_NOM_DOC>
  <TXT_APE_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="30" mode="edit" sqlconnection="workflow" optgroup="0"><![CDATA[ SELECT B.USR_LASTNAME FROM  PMT_PROFESIONAL A LEFT JOIN USERS B ON A.USR_UID = B.USR_UID WHERE A.DOCUMENTO = @#TXT_USERNAME]]><en>Apellidos</en><es>Apellidos</es></TXT_APE_DOC>
  <DRP_TIPO_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="30" mode="edit" sqlconnection="workflow" optgroup="0"><![CDATA[SELECT B.DESCRIPCION FROM  PMT_PROFESIONAL A LEFT JOIN PMT_DOCUMENTO B ON A.COD_DOCUMENTO=B.COD_DOCUMENTO WHERE A.DOCUMENTO = @#TXT_USERNAME]]><en>Tipo de Documento</en><es>Tipo de Documento</es></DRP_TIPO_DOC>
  <TXT_NUM_DOC_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="15" mode="edit" sqlconnection="workflow" optgroup="0"><![CDATA[SELECT DOCUMENTO FROM  PMT_PROFESIONAL WHERE DOCUMENTO = @#TXT_USERNAME]]><en>Número de Documento</en><es>Número de Documento</es></TXT_NUM_DOC_DOC>
  <TXT_EMAIL_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="40" mode="edit" sqlconnection="workflow" optgroup="0"><![CDATA[SELECT B.USR_EMAIL FROM  PMT_PROFESIONAL A LEFT JOIN USERS B ON A.USR_UID = B.USR_UID WHERE A.DOCUMENTO = @#TXT_USERNAME]]><en>Correo Eletrónico</en><es>Correo Eletrónico</es></TXT_EMAIL_DOC>
  <TXT_ESP_DOC type="text" maxlength="64" validate="Any" required="0" readonly="1" size="40" mode="edit" sqlconnection="workflow" optgroup="0"><![CDATA[SELECT ESPECIALIDAD FROM  PMT_PROFESIONAL WHERE DOCUMENTO = @#TXT_USERNAME]]><en>Especialidad</en><es>Especialidad</es></TXT_ESP_DOC>
  <SUB_AGENDA type="subtitle" required="0" readonly="0" optgroup="0">
    <es>DILIGENCIE LA NUEVA AGENDA</es>
  </SUB_AGENDA>
  <DATE_FECHA type="date" relativedate="1" beforedate="0d" afterdate="1m" mask="%Y-%m-%d" editable="0" required="0" readonly="0" defaultvalue_sel="empty" size="10" mode="edit" optgroup="0">
    <es><![CDATA[Fecha de Atención]]></es>
  </DATE_FECHA>
  <DRP_JORNADA type="dropdown" required="0" readonly="0" optgroup="0" mode="edit">
    <es>Jornada 
      <option name="0"><![CDATA[Mañana]]></option>
      <option name="1">Tarde</option>
      <option name="2">Noche</option>
      <option name="3">Madrugada</option></es>
  </DRP_JORNADA>
  <DRP_HORA_INICIO type="dropdown" required="0" readonly="0" optgroup="0" mode="edit">
    <es>Hora de Inicio
    <option name="0">00:00</option>
      <option name="1">01:00</option>
      <option name="2">02:00</option>
      <option name="3">02:00</option>
      <option name="4">03:00</option>
      <option name="5">04:00</option>
      <option name="6">05:00</option>
      <option name="7">06:00</option>
      <option name="8">07:00</option>
      <option name="9">08:00</option>
      <option name="10">09:00</option>
      <option name="11">10:00</option>
      <option name="12">11:00</option>
      <option name="13">12:00</option>
      <option name="14">13:00</option>
      <option name="15">14:00</option>
      <option name="16">15:00</option>
      <option name="17">16:00</option>
      <option name="18">17:00</option>
      <option name="19">18:00</option>
      <option name="20">19:00</option>
      <option name="21">20:00</option>
      <option name="22">21:00</option>
      <option name="23">22:00</option>
      <option name="24">23:00</option>
      <option name="25">23:40</option></es>
  </DRP_HORA_INICIO>
  <DRP_HORA_FIN type="dropdown" required="0" readonly="0" optgroup="0" mode="edit">
    <es>Hora de Fin
    <option name="0">00:00</option>
      <option name="1">01:00</option>
      <option name="2">02:00</option>
      <option name="3">02:00</option>
      <option name="4">03:00</option>
      <option name="5">04:00</option>
      <option name="6">05:00</option>
      <option name="7">06:00</option>
      <option name="8">07:00</option>
      <option name="9">08:00</option>
      <option name="10">09:00</option>
      <option name="11">10:00</option>
      <option name="12">11:00</option>
      <option name="13">12:00</option>
      <option name="14">13:00</option>
      <option name="15">14:00</option>
      <option name="16">15:00</option>
      <option name="17">16:00</option>
      <option name="18">17:00</option>
      <option name="19">18:00</option>
      <option name="20">19:00</option>
      <option name="21">20:00</option>
      <option name="22">21:00</option>
      <option name="23">22:00</option>
      <option name="24">23:00</option>
      <option name="25">23:40</option></es>
  </DRP_HORA_FIN>
  <DRP_ATENCION type="dropdown" required="0" readonly="0" optgroup="0" mode="edit" sqlconnection="734483671582fba5f8f5881092534303"><![CDATA[select cod_atencion,descripcion from hlt_atencion]]><en>Tipo de Atención                  
      <option name="99">Seleccione</option></en><es>Tipo de Atención            
      <option name="99">Seleccione</option></es></DRP_ATENCION>
  <BTN_AGENDAR type="button" required="0" readonly="0" optgroup="0">
    <es>Agendar Horario</es>
  </BTN_AGENDAR>
  <GRL_AGENDA_NUEVA type="grid" xmlgrid="604903739582fa3a17862f3041357520/742056429582fa534ea4d12068905339" addrow="0" deleterow="1" required="0" readonly="0" optgroup="0"/>
  <BTN_REGISTRAR type="submit" required="0" readonly="0" optgroup="0">
    <es>Registrar Agenda</es>
  </BTN_REGISTRAR>
  <validar_datos type="javascript" meta=""><![CDATA[//Valida la grilla antes de registrar la agenda
getField("BTN_REGISTRAR").form.onsubmit = function(){
  
  if(Number_Rows_Grid("GRL_AGENDA_NUEVA", "TXT_FECHA") == 1 && getGridField("GRL_AGENDA_NUEVA",1,"TXT_FECHA").value == ""){
    alert("Debe agendar al menos 1 día para registrar la agenda.");
    return false;
  }
  if(getField('TXT_NOM_DOC').value == ''){
    alert("Debe seleccionar un profesional para el cual se va a registrar la agenda.");
    return false;
  }
  return true;
}
  
getField('BTN_CANCELAR').onclick = function() {
  var r = confirm("Si cancela esta agenda, no se guardará ningún día agendado.");
  if (r == true) {
    getGridField("GRL_AGENDA_NUEVA",1,"TXT_FECHA").value = "";  
    submitForm();
  } 
  else {
      return false;
  }  
}

getField('BTN_AGENDAR').onclick = function() {

  var fecha= getField('DATE_FECHA').value;  
  var jornada = getField("DRP_JORNADA").options[getField('DRP_JORNADA').selectedIndex].text;
  var inicio= getField("DRP_HORA_INICIO").options[getField('DRP_HORA_INICIO').selectedIndex].text;
  var fin= getField("DRP_HORA_FIN").options[getField('DRP_HORA_FIN').selectedIndex].text;
  var atencion= getField("DRP_ATENCION").options[getField('DRP_ATENCION').selectedIndex].text;
  var dia = dia_semana(fecha);
  var i = inicio.split(':');
  var f = fin.split(':');
  
  if(fecha == ""){
     alert('Por favor, ingrese una fecha de atención.');
     return false;
  }
    
  if(jornada == 'Mañana'){
    if(parseInt(i[0]) < 6 || parseInt(f[0]) > 12 || parseInt(f[0]) < parseInt(i[0])){
      alert('El horario para la jornada de la mañana debe ser entre las 6 de la mañana y las 12 del medio día.');
      return false;
    }
  }
  
  if(jornada == 'Tarde'){
    if(parseInt(i[0]) < 12 || parseInt(f[0]) > 18 || parseInt(f[0]) < parseInt(i[0])){
      alert('El horario para la jornada de la tarde debe ser entre las 12 del medio día y las 6 de la tarde.');
      return false;
    }
  }
  
  if(jornada == 'Noche'){
    if(parseInt(i[0]) < 18 || parseInt(f[0]) < parseInt(i[0])){
      alert('El horario para la jornada de la noche debe ser entre las 6 y las 23:40 de la noche.');
      return false;
    }
  }
  
  if(jornada == 'Madrugada'){
    if(parseInt(i[0]) > parseInt(f[0]) || parseInt(f[0]) > 6){
      alert('El horario para la jornada de la madrugada debe ser entre las 00:20 de la noche y las 6 de la mañana.');
      return false;
    }
  }
  
  if(atencion == 'Seleccione'){
    alert('Debe seleccionar un tipo de atención');
    return false;
  }
  
  var nRows = Number_Rows_Grid("GRL_AGENDA_NUEVA","TXT_FECHA");
  /*for (var x = 1; x <= nRows; x++) {
      if (getGridField("GRL_AGENDA_NUEVA", x, "TXT_FECHA").value == fecha){
            if(getGridField("GRL_AGENDA_NUEVA", x, "TXT_DIA").value == dia){
              var gf = getGridField("GRL_AGENDA_NUEVA",x,"TXT_HORA_FIN").value.split(':');
              alert(i[0]+" "+gf[0]);
              if(i[0] < gf[0]){
                alert('Este horario se cruza o sobrepone con un horario ya agendado.');
                return false;
              }
            }
      }
  }*/
       
    if(Number_Rows_Grid("GRL_AGENDA_NUEVA", "TXT_FECHA") == 1 && getGridField("GRL_AGENDA_NUEVA",1,"TXT_FECHA").value == ""){
      getGridField("GRL_AGENDA_NUEVA",1,"TXT_FECHA").value = fecha;
      getGridField("GRL_AGENDA_NUEVA",1,"TXT_DIA").value = dia;
      getGridField("GRL_AGENDA_NUEVA",1,"TXT_JORNADA").value = jornada;
      getGridField("GRL_AGENDA_NUEVA",1,"TXT_HORA_INI").value = inicio; 
      getGridField("GRL_AGENDA_NUEVA",1,"TXT_HORA_FIN").value = fin; 
      getGridField("GRL_AGENDA_NUEVA",1,"TXT_TIPO").value = atencion;      
         
    }
    else{
      var y = nRows + 1;
      getObject("GRL_AGENDA_NUEVA").addGridRow();
      getGridField("GRL_AGENDA_NUEVA",y,"TXT_FECHA").value = fecha;
      getGridField("GRL_AGENDA_NUEVA",y,"TXT_DIA").value = dia;
      getGridField("GRL_AGENDA_NUEVA",y,"TXT_JORNADA").value = jornada;
      getGridField("GRL_AGENDA_NUEVA",y,"TXT_HORA_INI").value = inicio; 
      getGridField("GRL_AGENDA_NUEVA",y,"TXT_HORA_FIN").value = fin; 
      getGridField("GRL_AGENDA_NUEVA",y,"TXT_TIPO").value = atencion;   
            
    }
    
    getField('DATE_FECHA').value = "";
    getField('DRP_JORNADA').value = 0;
    getField('DRP_HORA_INICIO').value = 1;
    getField('DRP_HORA_FIN').value = 1;
    getField('DRP_ATENCION').value = 0;
    return false;
     
}
  
  
//Recibe fecha en formato YYYY-MM-DD
function dia_semana(fecha){   
    fecha=fecha.split('-');  
    if(fecha.length!=3){  
            alert('Ingrese una fecha valida');  
            return false;
    }  
    //Vector para calcular día de la semana de un año regular.  
    var regular =[0,3,3,6,1,4,6,2,5,0,3,5];   
    //Vector para calcular día de la semana de un año bisiesto.  
    var bisiesto=[0,3,4,0,2,5,0,3,6,1,4,6];   
    //Vector para hacer la traducción de resultado en día de la semana.  
    var semana=['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'];  
    //Día especificado en la fecha recibida por parametro.  
    var dia=fecha[2];  
    //Módulo acumulado del mes especificado en la fecha recibida por parametro.  
    var mes=fecha[1]-1;  
    //Año especificado por la fecha recibida por parametros.  
    var anno=fecha[0];  
    //Comparación para saber si el año recibido es bisiesto.  
    if((anno % 4 == 0) && !(anno % 100 == 0 && anno % 400 != 0))  
        mes=bisiesto[mes];  
    else  
        mes=regular[mes];  
    //Se retorna el resultado del calculo del día de la semana.  
    return semana[Math.ceil(Math.ceil(Math.ceil((anno-1)%7)+Math.ceil((Math.floor((anno-1)/4)-Math.floor((3*(Math.floor((anno-1)/100)+1))/4))%7)+mes+dia%7)%7)];  
}]]></validar_datos>
  <BTN_CANCELAR type="button" required="0" readonly="0" optgroup="0">
    <es>Cancelar Agenda</es>
  </BTN_CANCELAR>
</dynaForm>000000032926723442582fa58d946304042874862000004594<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
</head>
<body>
<form id="{$form_id}" class="formDefault" style="margin:0px;" action="{$form_action}" method="post" name="{$form_name}" enctype="multipart/form-data" onsubmit="return validateForm('{$form_objectRequiredFields}');">
<div class="borderForm" style="width:{$form_width}; padding-left:0; padding-right:0; border-width:{$form_border};">
<div class="boxTop">
<div class="a">&nbsp;</div>
<div class="b">&nbsp;</div>
<div class="c">&nbsp;</div>
</div>
<div class="content" style="height:{$form_height};">
<table class="mceItemTable" style="width: 99%;">
<tbody>
<tr>
<td valign="top"><input id="__notValidateThisFields__" class="notValidateThisFields" type="hidden" name="__notValidateThisFields__" value="{$form_objectRequiredFields}" /> <input id="DynaformRequiredFields" type="hidden" name="DynaformRequiredFields" value="{$form_objectRequiredFields}" /> <input id="__DynaformName__" type="hidden" name="__DynaformName__" value="{$form_name}" />
<table class="mceItemTable" style="width: 100%;" border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormTitle" colspan="2" align="center">{$form.TIT_PRINCIPAL}</td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormSubTitle" colspan="2" align=""><span>{$form.SUB_INFORMACION}</span></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align=""><font color="#000000"><span>{$TXT_USERNAME}&nbsp;</span><span>{$form.TXT_USERNAME}</span></font></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align=""><font color="#000000"><span><span>{$TXT_NOM_DOC}</span>{$form.TXT_NOM_DOC} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span>&nbsp; &nbsp;</span><span>{$TXT_APE_DOC}&nbsp;{$form.TXT_APE_DOC}</span></span></font></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align=""><font color="#000000">{$DRP_TIPO_DOC}&nbsp;<span>{$form.DRP_TIPO_DOC} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span>{$TXT_NUM_DOC_DOC}&nbsp;</span><span>{$form.TXT_NUM_DOC_DOC}</span>&nbsp;&nbsp;</span></font></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align=""><font color="#000000">{$TXT_ESP_DOC}&nbsp;<span>{$form.TXT_ESP_DOC} &nbsp; &nbsp; &nbsp; &nbsp;<span>{$TXT_EMAIL_DOC}&nbsp;</span><span>{$form.TXT_EMAIL_DOC}</span></span></font></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormSubTitle" colspan="2" align=""><span>{$form.SUB_AGENDA}</span></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align="center">{$DATE_FECHA}&nbsp;<span>{$form.DATE_FECHA}<span>{$DRP_JORNADA}&nbsp;<span>{$form.DRP_JORNADA}<span>{$DRP_HORA_INICIO}&nbsp;</span><span>{$form.DRP_HORA_INICIO} &nbsp;{$DRP_HORA_FIN}&nbsp;{$form.DRP_HORA_FIN} &nbsp;{$DRP_ATENCION}&nbsp;{$form.DRP_ATENCION}</span></span></span></span></td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align="center">{$form.BTN_AGENDAR}</td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td colspan="2">{$form.GRL_AGENDA_NUEVA}</td>
</tr>
<tr style="background-color: #bdcedb; " data-mce-style="background-color: #bdcedb; ">
<td class="FormButton" colspan="2" align="">{$form.BTN_REGISTRAR} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span>{$form.BTN_CANCELAR}</span></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="boxBottom">
<div class="a">&nbsp;</div>
<div class="b">&nbsp;</div>
<div class="c">&nbsp;</div>
</div>
</div>
<script type="text/javascript">// <![CDATA[
{$form.arrow}
// ]]></script>
<script type="text/javascript">// <![CDATA[
{$form.validar_datos}
// ]]></script>
<br />{$__DYNAFORM_OPTIONS}{$form.__DYNAFORM_OPTIONS}</form>
MAILTEMPL000000018alert_message.html000000682
<table style=\"background-color: white; font-family: Arial,Helvetica,sans-serif; color: black; font-size: 11px; text-align: left;\" cellpadding='10' cellspacing='0' width='100%'>
<tbody>	
		<tr><td style='font-size: 14px;'><b>ALERT MESSAGE</b></td></tr>
		<tr><td style='vertical-align:middel;'>
				<hr>
				<br />
						The Case <b>@#APP_NUMBER</b>, currently in the task <b>@#TAS_TITLE</b>, expired on <b>@#DEL_TASK_DUE_DATE</b>.						
				<br />		
				<br />
				<hr><b>This Business Process is powered by ProcessMaker.<b><br />
						<a href='http://www.processmaker.com' style='color:#c40000;'>www.processmaker.com</a>
				<br />
		</td></tr>
</tbody>
</table>